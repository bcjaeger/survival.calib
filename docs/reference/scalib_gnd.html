<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Greenwood-Nam-D'Agostino (GND) Test — scalib_gnd • survival.calib</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Greenwood-Nam-D'Agostino (GND) Test — scalib_gnd" />
<meta property="og:description" content="Demler et al developed a modification of the Nam-D'Agostino test that has
nominal type 1 error rates with censored outcomes. The
Greenwood-Nam-D'Agostino (GND) test is applicable in settings where
the proportional hazards assumption is invalid. The GND test is based
on groupwise error rates for observed versus expected risk, and the
test is unstable when any group contains &amp;lt; 5 events (see Demler et al.)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survival.calib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basics.html">The basics</a>
    </li>
    <li>
      <a href="../articles/comparisons.html">Comparing calibration of multiple models</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Resampling with scalib objects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bcjaeger/survival.calib/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Greenwood-Nam-D'Agostino (GND) Test</h1>
    <small class="dont-index">Source: <a href='https://github.com/bcjaeger/survival.calib/blob/master/R/scalib_gnd.R'><code>R/scalib_gnd.R</code></a>, <a href='https://github.com/bcjaeger/survival.calib/blob/master/R/vec_gnd.R'><code>R/vec_gnd.R</code></a></small>
    <div class="hidden name"><code>scalib_gnd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Demler et al developed a modification of the Nam-D'Agostino test that has
nominal type 1 error rates with censored outcomes. The
Greenwood-Nam-D'Agostino (GND) test is applicable in settings where
the proportional hazards assumption is invalid. The GND test is based
on groupwise error rates for observed versus expected risk, and the
test is unstable when any group contains &lt; 5 events (see Demler et al.).</p>
    </div>

    <pre class="usage"><span class='fu'>scalib_gnd</span><span class='op'>(</span>
  <span class='va'>scalib_object</span>,
  group_method <span class='op'>=</span> <span class='st'>"lump"</span>,
  group_count_init <span class='op'>=</span> <span class='fl'>10</span>,
  group_count_min <span class='op'>=</span> <span class='fl'>2</span>,
  group_min_events <span class='op'>=</span> <span class='fl'>5</span>,
  verbose <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>

<span class='fu'>scalib_gnd_manual</span><span class='op'>(</span>
  <span class='va'>scalib_object</span>,
  <span class='va'>pred_risk_col</span>,
  <span class='va'>group</span>,
  group_min_events_warn <span class='op'>=</span> <span class='fl'>5</span>,
  group_min_events_stop <span class='op'>=</span> <span class='fl'>2</span>,
  verbose <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>

<span class='fu'>vec_gnd</span><span class='op'>(</span>
  <span class='va'>pred_risk</span>,
  <span class='va'>pred_horizon</span>,
  <span class='va'>event_status</span>,
  <span class='va'>event_time</span>,
  group_method <span class='op'>=</span> <span class='st'>"lump"</span>,
  group_count_init <span class='op'>=</span> <span class='fl'>10</span>,
  group_count_min <span class='op'>=</span> <span class='fl'>2</span>,
  group_min_events <span class='op'>=</span> <span class='fl'>5</span>,
  verbose <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span>

<span class='fu'>vec_gnd_manual</span><span class='op'>(</span>
  <span class='va'>pred_risk</span>,
  <span class='va'>pred_horizon</span>,
  <span class='va'>event_status</span>,
  <span class='va'>event_time</span>,
  <span class='va'>group</span>,
  group_min_events_warn <span class='op'>=</span> <span class='fl'>5</span>,
  group_min_events_stop <span class='op'>=</span> <span class='fl'>2</span>,
  verbose <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>scalib_object</th>
      <td><p>An object of class <code>scalib</code>
(see <a href='scalib.html'>scalib</a>).</p></td>
    </tr>
    <tr>
      <th>group_method</th>
      <td><p>(<em>character value</em>; 'lump' or 'redo') If 'lump', then
a 'lumping' procedure will be applied whenever a group has less than
<code>group_min_events_warn</code> events. The lumping procedure will identify
whichever group has the lowest event count and assign members of that
group to the group with too few events. If 'redo', then the groups
will be re-done using <a href='predrisk_grp_prcnt.html'>predrisk_grp_prcnt</a> but with one less group.
'lump' is the default as this method was studied by Demler et al.</p></td>
    </tr>
    <tr>
      <th>group_count_init</th>
      <td><p>(<em>integer value</em>) the initial number of
groups to form based on percentiles of <code>predicted_risk</code> values.</p></td>
    </tr>
    <tr>
      <th>group_count_min</th>
      <td><p>(<em>integer value</em>) the minimum number of
groups to attempt running the GND test with. Only relevant if
using <code>scalib_gnd_manual</code>.</p></td>
    </tr>
    <tr>
      <th>group_min_events</th>
      <td><p>(<em>numeric value</em>) The minimum number of events
within a risk group (see details).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>(<em>integer value</em>) If 0, no output will be printed.
If 1, some output will be printed. If 2, <em>all</em> output will be printed.</p></td>
    </tr>
    <tr>
      <th>pred_risk_col</th>
      <td><p>(<em>character value</em>) the column name of the variable
that contains predicted risk values. This variable should be in
<code>scalib_object$data_inputs</code>.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>(<em>numeric vector</em>) Only relevant if using <code>scalib_gnd_manual</code>.
An integer valued vector with group values starting at 1 and increasing
by 1 for each additional group. These risk groups are used to run the
GND test.</p></td>
    </tr>
    <tr>
      <th>group_min_events_warn</th>
      <td><p>(<em>numeric value</em>) The lowest event count
within a risk group that will not cause a warning (see details).
Only relevant if using <code>scalib_gnd_manual</code>.</p></td>
    </tr>
    <tr>
      <th>group_min_events_stop</th>
      <td><p>(<em>numeric value</em>) The lowest event count
within a risk group that will not cause a hard stop (see details).
Only relevant if using <code>scalib_gnd_manual</code>.</p></td>
    </tr>
    <tr>
      <th>pred_risk</th>
      <td><p>(<em>numeric vector</em>, <em>list</em>, <em>data frame</em>, or <em>matrix</em>)
predicted risk values for the event at or before <code>pred_horizon</code></p></td>
    </tr>
    <tr>
      <th>pred_horizon</th>
      <td><p>(<em>numeric value</em>) the time of risk prediction.</p></td>
    </tr>
    <tr>
      <th>event_status</th>
      <td><p>(<em>numeric vector</em>) observed event status. The values
of this vector should be 0 (event censored) and 1 (event observed).</p></td>
    </tr>
    <tr>
      <th>event_time</th>
      <td><p>(<em>numeric vector</em>) observed event times</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>scalib</code> (see <a href='scalib.html'>scalib</a>)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>scalib_gnd</code> automatically forms risk groups, checks event counts
in risk groups and, if necessary, collapses risk groups so that
every group has an event count greater than a given threshold.</p>
<p><code>scalib_gnd_manual</code> completes the GND test, but requires the user to</p><ol>
<li><p>create a column in the scalib_object$data_inputs that contains
risk group labels (see <a href='predrisk_grp_prcnt.html'>predrisk_grp_prcnt</a>)</p></li>
<li><p>specify the column name of the risk group column and the
predicted risk column.</p></li>
</ol>

<p><strong>Minimum event counts for risk groups</strong>: Low event counts within any risk
group may cause high variability in the GND test results. It is recommended
that all risk groups have at least 5 events, and this is why the default
value of <code>group_min_events_warn</code> is 5. If there are less than 2 events
in any group, the GND test is unstable and risk groups should be collapsed.
Therefore, the default value of <code>group_min_events_stop</code> is 2.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Demler, O.V., Paynter, N.P. and Cook, N.R., 2015. Tests of calibration and
goodness‐of‐fit in the survival setting. <em>Statistics in medicine</em>, 34(10),
pp.1659-1680. DOI: 10.1002/sim.6428</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='va'>sc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='scalib.html'>scalib</a></span><span class='op'>(</span>pred_risk <span class='op'>=</span> <span class='va'>pbc_scalib</span><span class='op'>$</span><span class='va'>predrisk</span>,</span>
<span class='r-in'>             pred_horizon <span class='op'>=</span> <span class='fl'>2500</span>,</span>
<span class='r-in'>             event_time <span class='op'>=</span> <span class='va'>pbc_scalib</span><span class='op'>$</span><span class='va'>test</span><span class='op'>$</span><span class='va'>time</span>,</span>
<span class='r-in'>             event_status <span class='op'>=</span> <span class='va'>pbc_scalib</span><span class='op'>$</span><span class='va'>test</span><span class='op'>$</span><span class='va'>status</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># run GND test using 10 groups; apply some rules:</span></span>
<span class='r-in'><span class='co'>#  1. require at least 40 events per group</span></span>
<span class='r-in'><span class='co'>#  2. try to create 10 groups, and lump the lowest event frequency groups</span></span>
<span class='r-in'><span class='co'>#     if any groups have less than 40 events.</span></span>
<span class='r-in'><span class='co'>#  3. Hard stop if this is not obtainable with 5 or more groups.</span></span>
<span class='r-in'><span class='co'>#  4. set verbose = 2 to see every detail.</span></span>
<span class='r-in'><span class='co'># (note that these rules are not a recommendation on how to use the test;</span></span>
<span class='r-in'><span class='co'>#  this example just shows the mechanics of the automatic group reduction.</span></span>
<span class='r-in'><span class='co'>#  The recommended values are the default values.)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>scalib_gnd</span><span class='op'>(</span><span class='va'>sc</span>,</span>
<span class='r-in'>           group_min_events <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span class='r-in'>           group_count_init <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span class='r-in'>           group_count_min <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span class='r-in'>           verbose <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Checking event counts using 10 risk groups...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> too few; trying again</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Checking event counts using 9 risk groups...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> too few; trying again</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Checking event counts using 8 risk groups...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> too few; trying again</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Checking event counts using 7 risk groups...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> too few; trying again</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Checking event counts using 6 risk groups...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> too few; trying again</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Checking event counts using 5 risk groups...</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> okay</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Survival calibration object with prediction horizon of 2500</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> -- Input data ----------------------------------------------------------------</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      event_time event_status prop_hazard rsf_axis gradient_booster rsf_oblique</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           &lt;int&gt;        &lt;num&gt;       &lt;num&gt;    &lt;num&gt;            &lt;num&gt;       &lt;num&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1:        400            1      0.9990   0.9026           0.9351      0.9463</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2:       4500            0      0.4272   0.3072           0.0524      0.3680</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3:       1925            1      0.8286   0.4722           0.2342      0.5982</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4:       1832            0      0.0358   0.1474           0.0422      0.1460</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5:       2466            1      0.0392   0.1925           0.0568      0.1558</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  ---                                                                          </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 134:       1300            0      0.1509   0.1783           0.0629      0.1669</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 135:       1293            0      0.1805   0.3466           0.1299      0.2416</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 136:       1250            0      0.9823   0.4743           0.3254      0.5727</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 137:       1230            0      0.0182   0.0589           0.0322      0.0637</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 138:       1153            0      0.0718   0.1637           0.0527      0.1220</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> -- Output data --------------------------------------------------</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Key: &lt;._id_.&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>              ._id_. gnd_df gnd_chisq gnd_pvalue          gnd_data</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>              &lt;fctr&gt;  &lt;num&gt;     &lt;num&gt;      &lt;num&gt;            &lt;list&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1:      prop_hazard      4     12.20   1.59e-02 &lt;data.table[5x8]&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2:         rsf_axis      4      6.00   1.99e-01 &lt;data.table[5x8]&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3: gradient_booster      5     28.99   2.33e-05 &lt;data.table[6x8]&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4:      rsf_oblique      4      5.63   2.28e-01 &lt;data.table[5x8]&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 variable not shown: [gnd_group_method &lt;char&gt;]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Byron Jaeger, Olga Demler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


