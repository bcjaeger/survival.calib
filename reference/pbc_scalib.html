<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Mayo Clinic Primary Biliary Cholangitis Data — pbc_scalib • survival.calib</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Mayo Clinic Primary Biliary Cholangitis Data — pbc_scalib"><meta property="og:description" content="pbc_scalib is a list with three datasets: train, test, and
predrisk.
train is the data used to train A proportional hazards model,
a gradient boosting tree ensemble, and a random forest with axis
based and oblique splits.
test is the data that the trained models computed predictions for.
predrisk is the predicted risk values for the models listed above.
The prediction horizon for these predictions is 2,500 days after
baseline assessment. Put another way, predicted values are the
predicted probability that a person will have an event within
2,500 of baseline.


The train and test data are a light modification of the
survival::pbc data. The modifications are:
removed rows with missing data
converted status into 0 for censor or transplant, 1 for dead
removed the id column.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survival.calib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basics.html">The basics</a>
    </li>
    <li>
      <a href="../articles/comparisons.html">Comparing calibration of multiple models</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Resampling with scalib objects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bcjaeger/survival.calib/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mayo Clinic Primary Biliary Cholangitis Data</h1>
    <small class="dont-index">Source: <a href="https://github.com/bcjaeger/survival.calib/blob/HEAD/R/data-pbc_scalib.R" class="external-link"><code>R/data-pbc_scalib.R</code></a></small>
    <div class="hidden name"><code>pbc_scalib.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>pbc_scalib</code> is a list with three datasets: <code>train</code>, <code>test</code>, and
<code>predrisk</code>.</p><ul><li><p><code>train</code> is the data used to train A proportional hazards model,
a gradient boosting tree ensemble, and a random forest with axis
based and oblique splits.</p></li>
<li><p><code>test</code> is the data that the trained models computed predictions for.</p></li>
<li><p><code>predrisk</code> is the predicted risk values for the models listed above.
The prediction horizon for these predictions is 2,500 days after
baseline assessment. Put another way, predicted values are the
predicted probability that a person will have an event within
2,500 of baseline.</p></li>
</ul><p>The <code>train</code> and <code>test</code> data are a light modification of the
<a href="https://rdrr.io/pkg/survival/man/pbc.html" class="external-link">survival::pbc</a> data. The modifications are:</p><ol><li><p>removed rows with missing data</p></li>
<li><p>converted <code>status</code> into 0 for censor or transplant, 1 for dead</p></li>
<li><p>removed the <code>id</code> column.</p></li>
</ol></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="va">pbc_scalib</span></code></pre></div>
    </div>

    <div id="format">
    <h2>Format</h2>
    <p><strong>train and test</strong> are random subsets of roughly equal size from a
dataset with 276 rows and 20 variables. Those variables are:</p><dl><dt>time</dt>
<dd><p>number of days between registration and the earlier of death, transplantion, or study analysis in July, 1986</p></dd>

<dt>status</dt>
<dd><p>status at endpoint, 0 for censored or transplant, 1 for dead</p></dd>

<dt>trt</dt>
<dd><p>1/2/NA for D-penicillmain, placebo, not randomised</p></dd>

<dt>age</dt>
<dd><p>in years</p></dd>

<dt>sex</dt>
<dd><p>m/f</p></dd>

<dt>ascites</dt>
<dd><p>presence of ascites</p></dd>

<dt>hepato</dt>
<dd><p>presence of hepatomegaly or enlarged liver</p></dd>

<dt>spiders</dt>
<dd><p>blood vessel malformations in the skin</p></dd>

<dt>edema</dt>
<dd><p>0 no edema, 0.5 untreated or successfully treated 1 edema despite diuretic therapy</p></dd>

<dt>bili</dt>
<dd><p>serum bilirunbin (mg/dl)</p></dd>

<dt>chol</dt>
<dd><p>serum cholesterol (mg/dl)</p></dd>

<dt>albumin</dt>
<dd><p>serum albumin (g/dl)</p></dd>

<dt>copper</dt>
<dd><p>urine copper (ug/day)</p></dd>

<dt>alk.phos</dt>
<dd><p>alkaline phosphotase (U/liter)</p></dd>

<dt>ast</dt>
<dd><p>aspartate aminotransferase, once called SGOT (U/ml)</p></dd>

<dt>trig</dt>
<dd><p>triglycerides (mg/dl)</p></dd>

<dt>platelet</dt>
<dd><p>platelet count</p></dd>

<dt>protime</dt>
<dd><p>standardised blood clotting time</p></dd>

<dt>stage</dt>
<dd><p>histologic stage of disease (needs biopsy)</p></dd>


</dl><p><strong>predrisk</strong> is a dataset with 138 rows and 4 variables:</p><dl><dt>prop_hazard</dt>
<dd><p>predictions from a proportional hazards model</p></dd>

<dt>rsf_axis</dt>
<dd><p>predictions from a gradient boosting tree ensemble</p></dd>

<dt>gradient_booster</dt>
<dd><p>predictions from a random forest with axis based splits</p></dd>

<dt>rsf_oblique</dt>
<dd><p>predictions from a random forest with oblique splits</p></dd>


</dl></div>
    <div id="source">
    <h2>Source</h2>
    <p>T Therneau and P Grambsch (2000), Modeling Survival Data: Extending the Cox Model, Springer-Verlag, New York. ISBN: 0-387-98784-3.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>See <code>example</code> for code to generate the data and fit the models</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tagteam/riskRegression" class="external-link">riskRegression</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.randomforestsrc.org/" class="external-link">randomForestSRC</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gbm-developers/gbm" class="external-link">gbm</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">orsf2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">pbc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">pbc</span><span class="op">)</span>, <span class="op">]</span></span>
<span class="r-in"><span class="va">dataset</span><span class="op">$</span><span class="va">status</span><span class="op">[</span><span class="va">dataset</span><span class="op">$</span><span class="va">status</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="va">status</span><span class="op">[</span><span class="va">dataset</span><span class="op">$</span><span class="va">status</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span></span>
<span class="r-in"><span class="va">dataset</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span class="r-in"><span class="va">dataset</span><span class="op">$</span><span class="va">stage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">stage</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_total</span> <span class="op">*</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">32987</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">train_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n_train</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dataset_train</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">[</span><span class="va">train_index</span>, <span class="op">]</span></span>
<span class="r-in"><span class="va">dataset_test</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">[</span><span class="op">-</span><span class="va">train_index</span>, <span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">cph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span class="r-in">             data <span class="op">=</span> <span class="va">dataset_train</span>,</span>
<span class="r-in">             x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu">rfsrc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span class="r-in">            data <span class="op">=</span> <span class="va">dataset_train</span>,</span>
<span class="r-in">            nodesize <span class="op">=</span> <span class="fl">15</span>,</span>
<span class="r-in">            ntree <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">bst_cv</span> <span class="op">&lt;-</span> <span class="fu">gbm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span class="r-in">              data <span class="op">=</span> <span class="va">dataset_train</span>,</span>
<span class="r-in">              interaction.depth <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">              shrinkage <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span class="r-in">              n.trees <span class="op">=</span> <span class="fl">500</span>,</span>
<span class="r-in">              cv.folds <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">bst_final</span> <span class="op">&lt;-</span> <span class="fu">gbm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span class="r-in">                 data <span class="op">=</span> <span class="va">dataset_train</span>,</span>
<span class="r-in">                 interaction.depth <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">                 shrinkage <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span class="r-in">                 n.trees <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">aorsf</span> <span class="op">&lt;-</span> <span class="fu">orsf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataset_train</span>,</span>
<span class="r-in">              formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span class="r-in">              n_tree <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">predictRisk.aorsf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">times</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in"> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, new_data <span class="op">=</span> <span class="va">newdata</span>, times <span class="op">=</span> <span class="va">times</span>, risk <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prop_hazard <span class="op">=</span> <span class="va">cph</span>,</span>
<span class="r-in">               rsf_axis <span class="op">=</span> <span class="va">rf</span>,</span>
<span class="r-in">               gradient_booster <span class="op">=</span> <span class="va">bst_final</span>,</span>
<span class="r-in">               rsf_oblique <span class="op">=</span> <span class="va">aorsf</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">pred_horizon</span> <span class="op">&lt;-</span> <span class="fl">2500</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">data_predrisk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>,</span>
<span class="r-in">       <span class="va">predictRisk</span>,</span>
<span class="r-in">       newdata <span class="op">=</span> <span class="va">dataset_test</span>,</span>
<span class="r-in">       times <span class="op">=</span> <span class="va">pred_horizon</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">data_predrisk</span><span class="op">$</span><span class="va">prop_hazard</span><span class="op">[</span><span class="va">data_predrisk</span><span class="op">$</span><span class="va">prop_hazard</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.999</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Byron Jaeger, Olga Demler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

